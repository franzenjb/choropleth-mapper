<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GIS Database & Join Tool - Complete Documentation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/themes/prism-dark.min.css">
    <style>
        body { 
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); 
            min-height: 100vh; 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: white;
        }
        .doc-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        .nav-sidebar {
            position: sticky;
            top: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .nav-sidebar a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            display: block;
            padding: 8px 15px;
            border-radius: 5px;
            margin: 3px 0;
            transition: all 0.3s ease;
        }
        .nav-sidebar a:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
        }
        .btn-action {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            border: none;
            color: white;
            padding: 12px 25px;
            border-radius: 25px;
            text-decoration: none;
            display: inline-block;
            margin: 5px;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        .btn-action:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            color: white;
        }
        .btn-secondary-action {
            background: linear-gradient(45deg, #74b9ff, #0984e3);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            text-decoration: none;
            display: inline-block;
            margin: 3px;
            transition: all 0.3s ease;
        }
        .btn-secondary-action:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            color: white;
        }
        .code-block {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .feature-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
        }
        .feature-item:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }
        .alert-info {
            background: rgba(52, 152, 219, 0.2);
            border: 1px solid rgba(52, 152, 219, 0.4);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        .alert-success {
            background: rgba(46, 204, 113, 0.2);
            border: 1px solid rgba(46, 204, 113, 0.4);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        .alert-warning {
            background: rgba(241, 196, 15, 0.2);
            border: 1px solid rgba(241, 196, 15, 0.4);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        h1, h2, h3 { color: white; margin-top: 30px; }
        h1 { font-size: 2.5rem; text-align: center; margin-bottom: 20px; }
        h2 { font-size: 1.8rem; border-bottom: 2px solid rgba(255,255,255,0.3); padding-bottom: 10px; }
        h3 { font-size: 1.4rem; color: rgba(255,255,255,0.9); }
        .toc-link { color: #74b9ff !important; }
    </style>
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar Navigation -->
            <div class="col-md-3">
                <div class="nav-sidebar">
                    <h5>📚 Documentation</h5>
                    <a href="#overview" class="toc-link">📋 Overview</a>
                    <a href="#quick-start" class="toc-link">🚀 Quick Start</a>
                    <a href="#installation" class="toc-link">💾 Installation</a>
                    <a href="#data-formats" class="toc-link">📊 Data Formats</a>
                    <a href="#tools" class="toc-link">🛠️ Tool Suite</a>
                    <a href="#api-reference" class="toc-link">📖 API Reference</a>
                    <a href="#workflows" class="toc-link">🔄 Workflows</a>
                    <a href="#troubleshooting" class="toc-link">🐛 Troubleshooting</a>
                    <a href="#examples" class="toc-link">💡 Examples</a>
                    <a href="#support" class="toc-link">🤝 Support</a>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-md-9">
                <!-- Header -->
                <div class="doc-container">
                    <h1>🗺️ GIS Database & Join Tool</h1>
                    <p class="lead text-center">Complete Documentation & User Guide</p>
                    
                    <div class="text-center">
                        <a href="https://franzenjb.github.io/choropleth-mapper/" class="btn-action">🚀 LAUNCH APPLICATION</a>
                        <a href="https://franzenjb.github.io/choropleth-mapper/demo.html" class="btn-action">🎯 VIEW DEMO</a>
                        <a href="https://github.com/franzenjb/choropleth-mapper" class="btn-secondary-action">💾 DOWNLOAD CODE</a>
                        <a href="https://github.com/franzenjb/choropleth-mapper/actions" class="btn-secondary-action">📊 DEPLOY STATUS</a>
                    </div>
                </div>

                <!-- Overview Section -->
                <div class="doc-container" id="overview">
                    <h2>📋 Project Overview</h2>
                    <p>This comprehensive GIS platform automates the process of joining CSV data to geographic boundaries, creating professional choropleth maps for emergency management and demographic analysis.</p>
                    
                    <div class="alert-success">
                        <strong>🎯 Built for Emergency Management:</strong> Specifically designed for American Red Cross volunteer deployment, disaster response coordination, and resource allocation planning.
                    </div>

                    <div class="feature-grid">
                        <div class="feature-item">
                            <h4>🔗 Automated Joins</h4>
                            <p>Intelligently matches CSV data to geographic boundaries using FIPS codes, ZIP codes, or place names with fuzzy matching capabilities.</p>
                        </div>
                        <div class="feature-item">
                            <h4>🗃️ Comprehensive Database</h4>
                            <p>3.3GB of authoritative geospatial data including counties, ZIP codes, census tracts, emergency infrastructure, and demographic templates.</p>
                        </div>
                        <div class="feature-item">
                            <h4>📊 Professional Output</h4>
                            <p>Export to GeoJSON, Shapefile, CSV, and GeoPackage formats with complete data preservation and ArcGIS compatibility.</p>
                        </div>
                        <div class="feature-item">
                            <h4>🌐 Web & Command Line</h4>
                            <p>Both interactive web interfaces and powerful command-line tools for batch processing and automation.</p>
                        </div>
                    </div>
                </div>

                <!-- Quick Start -->
                <div class="doc-container" id="quick-start">
                    <h2>🚀 Quick Start Guide</h2>
                    
                    <h3>Web Interface (Recommended)</h3>
                    <ol>
                        <li><strong>Open Application:</strong> <a href="https://franzenjb.github.io/choropleth-mapper/" class="toc-link">Launch the web interface</a></li>
                        <li><strong>Upload CSV:</strong> Drag and drop your data file</li>
                        <li><strong>Select Geography:</strong> Choose Counties, ZIP Codes, Places, etc.</li>
                        <li><strong>Configure Map:</strong> Set visualization options</li>
                        <li><strong>Export Results:</strong> Download GeoJSON or Shapefile</li>
                    </ol>

                    <div class="alert-info">
                        <strong>💡 Pro Tip:</strong> Check the <a href="https://github.com/franzenjb/choropleth-mapper/actions" class="toc-link">deployment status</a> first to ensure the latest version is live (green ✓ = ready).
                    </div>

                    <h3>Command Line (Advanced)</h3>
                    <div class="code-block">
# Clone and setup
git clone https://github.com/franzenjb/choropleth-mapper.git
cd choropleth-mapper
pip install -r requirements.txt

# Basic join operation
python csv_shapefile_joiner.py \
  --csv your_data.csv \
  --layer counties \
  --csv-field FIPS_Code \
  --geo-field FIPS \
  --output results.geojson
                    </div>
                </div>

                <!-- Installation -->
                <div class="doc-container" id="installation">
                    <h2>💾 Installation Options</h2>

                    <h3>Option 1: Web Interface (No Installation)</h3>
                    <p>Use the hosted version directly in your browser:</p>
                    <div class="code-block">
🌐 Main App: https://franzenjb.github.io/choropleth-mapper/
🎯 Demo: https://franzenjb.github.io/choropleth-mapper/demo.html
                    </div>

                    <h3>Option 2: Local Installation</h3>
                    <div class="code-block">
# Requirements
- Python 3.8+
- Git

# Installation steps
git clone https://github.com/franzenjb/choropleth-mapper.git
cd choropleth-mapper
pip install -r requirements.txt

# Launch web interface
streamlit run streamlit_app.py

# Or use command-line tools
python gis_inventory.py
python csv_shapefile_joiner.py --help
                    </div>

                    <h3>Option 3: Data Population (Optional)</h3>
                    <div class="code-block">
# Download complete census data (2.8GB)
python download_census_data.py

# Download emergency infrastructure (400MB+)
python download_emergency_data.py

# Generate system inventory
python gis_inventory.py
                    </div>

                    <div class="alert-warning">
                        <strong>⚠️ Storage Note:</strong> Full data download requires 3.3GB. The GitHub repository contains tools only (14MB). Data is downloaded from government sources as needed.
                    </div>
                </div>

                <!-- Data Formats -->
                <div class="doc-container" id="data-formats">
                    <h2>📊 Data Format Requirements</h2>

                    <div class="feature-grid">
                        <div class="feature-item">
                            <h4>🏛️ Counties</h4>
                            <strong>Column:</strong> GEOID, FIPS, FIPS_Code, County_Name<br>
                            <strong>Format:</strong> 5-digit FIPS codes<br>
                            <strong>Example:</strong> 12086 (Miami-Dade, FL)<br>
                            <strong>Coverage:</strong> All 3,221 US counties
                        </div>
                        <div class="feature-item">
                            <h4>📮 ZIP Codes</h4>
                            <strong>Column:</strong> ZIP, zip, zip_code, zipcode<br>
                            <strong>Format:</strong> 5-digit ZIP codes<br>
                            <strong>Example:</strong> 32003 (Fleming Island, FL)<br>
                            <strong>Coverage:</strong> 33,092 ZIP Code Tabulation Areas
                        </div>
                        <div class="feature-item">
                            <h4>🏙️ Places/Cities</h4>
                            <strong>Column:</strong> GEOID<br>
                            <strong>Format:</strong> 7-digit place codes<br>
                            <strong>Example:</strong> 1200950 (Jacksonville, FL)<br>
                            <strong>Coverage:</strong> 30,000+ incorporated places
                        </div>
                        <div class="feature-item">
                            <h4>📍 Census Tracts</h4>
                            <strong>Column:</strong> GEOID<br>
                            <strong>Format:</strong> 11-digit tract codes<br>
                            <strong>Example:</strong> 12001020100<br>
                            <strong>Coverage:</strong> 70,000+ census tracts
                        </div>
                    </div>

                    <div class="alert-success">
                        <strong>✅ Auto-Detection:</strong> The system automatically identifies geographic columns and suggests appropriate geography types based on your data.
                    </div>
                </div>

                <!-- Tools -->
                <div class="doc-container" id="tools">
                    <h2>🛠️ Complete Tool Suite</h2>

                    <h3>Web Interfaces</h3>
                    <div class="feature-grid">
                        <div class="feature-item">
                            <h4>📊 Main Application</h4>
                            <p>Full-featured web interface with drag-and-drop CSV upload, interactive mapping, and export capabilities.</p>
                            <a href="https://franzenjb.github.io/choropleth-mapper/" class="btn-secondary-action">Launch App</a>
                        </div>
                        <div class="feature-item">
                            <h4>🎯 Interactive Demo</h4>
                            <p>Showcase of capabilities using Red Cross volunteer deployment data with live statistics and visualizations.</p>
                            <a href="https://franzenjb.github.io/choropleth-mapper/demo.html" class="btn-secondary-action">View Demo</a>
                        </div>
                        <div class="feature-item">
                            <h4>🐍 Streamlit Interface</h4>
                            <p>Advanced local interface with additional features for data exploration and batch processing.</p>
                            <code>streamlit run streamlit_app.py</code>
                        </div>
                    </div>

                    <h3>Command-Line Tools</h3>
                    <div class="code-block">
# GIS Inventory Scanner
python gis_inventory.py [--report] [--export-csv]

# CSV-Shapefile Joiner
python csv_shapefile_joiner.py --csv FILE --layer LAYER [options]

# Data Download Scripts
python download_census_data.py     # Census TIGER/Line data
python download_emergency_data.py  # Emergency infrastructure
                    </div>

                    <h3>Data Management Tools</h3>
                    <div class="feature-grid">
                        <div class="feature-item">
                            <h4>📋 Inventory System</h4>
                            <p>Scans and catalogs all geospatial assets with metadata tracking and coverage analysis.</p>
                        </div>
                        <div class="feature-item">
                            <h4>🔗 Join Engine</h4>
                            <p>Intelligent CSV-to-shapefile joining with fuzzy matching and quality control.</p>
                        </div>
                        <div class="feature-item">
                            <h4>📦 Auto-Download</h4>
                            <p>Automated acquisition of government datasets with progress tracking and error recovery.</p>
                        </div>
                    </div>
                </div>

                <!-- API Reference -->
                <div class="doc-container" id="api-reference">
                    <h2>📖 API Reference</h2>

                    <h3>CSV-Shapefile Joiner</h3>
                    <div class="code-block">
python csv_shapefile_joiner.py [OPTIONS]

Required Arguments:
  --csv FILE          Path to input CSV file
  --layer LAYER       Geographic layer (counties, zips, places, etc.)

Optional Arguments:
  --csv-field FIELD   CSV column name for joining
  --geo-field FIELD   Geographic field name for joining
  --fuzzy            Enable fuzzy string matching
  --output FILE      Output file path (default: auto-generated)
  --format FORMAT    Output format (geojson, shapefile, csv)

Examples:
  # County-level join by FIPS
  python csv_shapefile_joiner.py \
    --csv volunteers.csv \
    --layer counties \
    --csv-field FIPS_Code \
    --geo-field FIPS

  # ZIP code join with auto-detection
  python csv_shapefile_joiner.py \
    --csv demographics.csv \
    --layer zips

  # Fuzzy matching by county names
  python csv_shapefile_joiner.py \
    --csv data.csv \
    --layer counties \
    --csv-field County_Name \
    --geo-field NAME \
    --fuzzy
                    </div>

                    <h3>GIS Inventory Scanner</h3>
                    <div class="code-block">
python gis_inventory.py [OPTIONS]

Optional Arguments:
  --report           Generate detailed coverage report
  --export-csv       Export inventory to CSV format
  --update           Update existing inventory database

Output:
  - gis_inventory.csv     # Tabular inventory
  - gis_metadata.db       # SQLite database
  - Coverage reports      # Detailed analysis
                    </div>
                </div>

                <!-- Workflows -->
                <div class="doc-container" id="workflows">
                    <h2>🔄 Sample Workflows</h2>

                    <h3>🆘 Red Cross Volunteer Deployment</h3>
                    <ol>
                        <li><strong>Prepare Data:</strong> Create CSV with County_Name/FIPS + volunteer counts</li>
                        <li><strong>Upload to Tool:</strong> Use web interface or command line</li>
                        <li><strong>Configure Visualization:</strong> Select color scheme and classification</li>
                        <li><strong>Export for ArcGIS:</strong> Download GeoJSON/Shapefile</li>
                        <li><strong>Analyze Coverage:</strong> Review join statistics and gaps</li>
                    </ol>

                    <div class="code-block">
# Example Red Cross workflow
python csv_shapefile_joiner.py \
  --csv sample_red_cross_data.csv \
  --layer counties \
  --csv-field FIPS_Code \
  --geo-field FIPS \
  --output red_cross_counties_mapped.geojson

# Results: 100% join success rate (10/10 counties)
# Population served: 12.1M residents
# Total volunteers: 1,595
                    </div>

                    <h3>🏠 ALICE Demographic Analysis</h3>
                    <ol>
                        <li><strong>Clean Raw Data:</strong> Use data cleaning scripts</li>
                        <li><strong>Select Geography:</strong> Counties, ZIPs, or places</li>
                        <li><strong>Join Demographics:</strong> Automatic ACS integration</li>
                        <li><strong>Create Choropleth:</strong> Visualize patterns</li>
                        <li><strong>Export Analysis:</strong> Multiple format options</li>
                    </ol>

                    <h3>🌪️ Emergency Preparedness Planning</h3>
                    <ol>
                        <li><strong>Inventory Assets:</strong> Run GIS scanner</li>
                        <li><strong>Load Infrastructure:</strong> Hospitals, shelters, fire stations</li>
                        <li><strong>Join Population Data:</strong> Census demographics</li>
                        <li><strong>Analyze Coverage:</strong> Identify service gaps</li>
                        <li><strong>Plan Improvements:</strong> Resource allocation optimization</li>
                    </ol>
                </div>

                <!-- Troubleshooting -->
                <div class="doc-container" id="troubleshooting">
                    <h2>🐛 Troubleshooting Guide</h2>

                    <h3>Common Issues & Solutions</h3>
                    
                    <div class="alert-warning">
                        <strong>❌ Problem:</strong> Map shows ocean instead of data<br>
                        <strong>✅ Solution:</strong> Click the "Zoom to Features" button after processing
                    </div>

                    <div class="alert-warning">
                        <strong>❌ Problem:</strong> Low join success rate<br>
                        <strong>✅ Solution:</strong> Check data format requirements, ensure proper FIPS/ZIP formatting
                    </div>

                    <div class="alert-warning">
                        <strong>❌ Problem:</strong> API limit exceeded<br>
                        <strong>✅ Solution:</strong> Use state filter to reduce dataset size, or split large CSVs
                    </div>

                    <div class="alert-warning">
                        <strong>❌ Problem:</strong> Raw ALICE data won't join<br>
                        <strong>✅ Solution:</strong> Use the provided data cleaning scripts first
                    </div>

                    <h3>Data Quality Checklist</h3>
                    <ul>
                        <li>✅ FIPS codes are 5 digits (counties) or 11 digits (tracts)</li>
                        <li>✅ ZIP codes are 5 digits with leading zeros preserved</li>
                        <li>✅ Column names match expected patterns (GEOID, FIPS, ZIP, etc.)</li>
                        <li>✅ No extra characters or suffixes (_ZCTA, etc.)</li>
                        <li>✅ Numeric data columns are properly formatted</li>
                    </ul>

                    <h3>Performance Optimization</h3>
                    <div class="code-block">
# For large datasets:
1. Use state filtering to reduce API calls
2. Process in batches by region
3. Use county-level instead of tract-level for broad analysis
4. Pre-clean data to improve match rates
                    </div>
                </div>

                <!-- Examples -->
                <div class="doc-container" id="examples">
                    <h2>💡 Real-World Examples</h2>

                    <h3>🔴 American Red Cross - Florida Counties</h3>
                    <div class="code-block">
Input CSV: sample_red_cross_data.csv
Columns: County_Name, State, FIPS_Code, Red_Cross_Volunteers, Emergency_Shelters, Population_Served

Results:
✅ 10/10 counties successfully matched (100%)
✅ 1,595 total volunteers mapped
✅ 64 emergency shelters identified
✅ 12.1M population coverage
                    </div>

                    <h3>📊 ALICE Demographic Analysis</h3>
                    <div class="code-block">
Input: ALICE County Data (Asset Limited, Income Constrained, Employed)
Process: Aggregate sub-county divisions to county level
Output: Choropleth map showing household financial stability by county
Usage: Program planning and resource allocation
                    </div>

                    <h3>🏥 Healthcare Facility Coverage</h3>
                    <div class="code-block">
Input: Hospital locations + ZIP code service areas
Process: Join facility counts to ZIP boundaries
Output: Maps showing healthcare access gaps
Usage: Public health planning and emergency response
                    </div>

                    <h3>Sample Data Files</h3>
                    <ul>
                        <li><strong>sample_red_cross_data.csv</strong> - Red Cross volunteer deployment</li>
                        <li><strong>example_counties.csv</strong> - County-level demographic data</li>
                        <li><strong>example_zipcodes.csv</strong> - ZIP code ALICE analysis</li>
                        <li><strong>example_places.csv</strong> - City/place population data</li>
                    </ul>
                </div>

                <!-- Support -->
                <div class="doc-container" id="support">
                    <h2>🤝 Support & Community</h2>

                    <h3>Getting Help</h3>
                    <div class="feature-grid">
                        <div class="feature-item">
                            <h4>🐛 Bug Reports</h4>
                            <p>Found an issue? Report it on GitHub Issues with sample data and error messages.</p>
                            <a href="https://github.com/franzenjb/choropleth-mapper/issues" class="btn-secondary-action">Report Issue</a>
                        </div>
                        <div class="feature-item">
                            <h4>💬 Discussions</h4>
                            <p>Ask questions, share use cases, and get community support.</p>
                            <a href="https://github.com/franzenjb/choropleth-mapper/discussions" class="btn-secondary-action">Join Discussion</a>
                        </div>
                        <div class="feature-item">
                            <h4>📚 Documentation</h4>
                            <p>Comprehensive guides, API reference, and examples.</p>
                            <a href="https://github.com/franzenjb/choropleth-mapper/wiki" class="btn-secondary-action">View Wiki</a>
                        </div>
                    </div>

                    <h3>Contributing</h3>
                    <p>We welcome contributions from the GIS and emergency management community:</p>
                    <ul>
                        <li><strong>Code Contributions:</strong> Fork the repository and submit pull requests</li>
                        <li><strong>Data Sharing:</strong> Share cleaned datasets and real-world examples</li>
                        <li><strong>Documentation:</strong> Improve guides and add use cases</li>
                        <li><strong>Testing:</strong> Test with different data types and report issues</li>
                    </ul>

                    <h3>Professional Services</h3>
                    <div class="alert-info">
                        <strong>Enterprise Support Available:</strong>
                        <ul>
                            <li>Custom implementations for large organizations</li>
                            <li>Training workshops and hands-on support</li>
                            <li>Data integration and workflow automation</li>
                            <li>Scalable deployment solutions</li>
                        </ul>
                    </div>

                    <h3>Contact Information</h3>
                    <p><strong>Created By:</strong> Jeff Franzen - GIS Developer & Emergency Management Technology Specialist</p>
                    <p><strong>Built For:</strong> American Red Cross GIS Program</p>
                    <p><strong>GitHub:</strong> <a href="https://github.com/franzenjb/choropleth-mapper" class="toc-link">franzenjb/choropleth-mapper</a></p>
                </div>

                <!-- Footer -->
                <div class="doc-container text-center">
                    <h3>🎯 Ready to Get Started?</h3>
                    <div class="mb-3">
                        <a href="https://franzenjb.github.io/choropleth-mapper/" class="btn-action">🚀 LAUNCH APPLICATION</a>
                        <a href="https://franzenjb.github.io/choropleth-mapper/demo.html" class="btn-action">🎯 VIEW DEMO</a>
                    </div>
                    <p><strong>Questions?</strong> Open an issue or start a discussion on GitHub!</p>
                    <hr style="border-color: rgba(255,255,255,0.3); margin: 30px 0;">
                    <p><em>Last Updated: January 2025 | Version 2.0 | Emergency Management Focus</em></p>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Smooth scrolling for navigation links
        document.querySelectorAll('.toc-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href').substring(1);
                const target = document.getElementById(targetId);
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });

        // Highlight current section in navigation
        window.addEventListener('scroll', function() {
            const sections = document.querySelectorAll('[id]');
            const navLinks = document.querySelectorAll('.toc-link');
            
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop - 100;
                if (window.pageYOffset >= sectionTop) {
                    current = section.getAttribute('id');
                }
            });

            navLinks.forEach(link => {
                link.style.background = '';
                link.style.color = '';
                if (link.getAttribute('href') === `#${current}`) {
                    link.style.background = 'rgba(255, 255, 255, 0.1)';
                    link.style.color = 'white';
                }
            });
        });
    </script>
</body>
</html>